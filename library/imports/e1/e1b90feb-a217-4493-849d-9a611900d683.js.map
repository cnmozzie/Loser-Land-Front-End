{"version":3,"sources":["assets\\Script\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport {ethers} from 'ethers/dist/ethers.umd.min.js';\r\n\r\nenum Status {Schedule, Committing, Committed, Confirmmed};\r\nenum Action {SitStill, GoLeft, GoRight, GoUp, GoDown, GoLeftUp, GoLeftDown, GoRightUp, GoRightDown};\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\t\r\n\tid: number = 0;\r\n\tt: number = 0;\r\n\tcurrentSchedule: number = 0;\r\n\ttoCommit: number = 0;\r\n\tmode: string = \"view\";\r\n\trogueLandAddress: string = '0xE9f1e59d52d66a0fF973B85f8f4744350c15E924';\r\n\trogueLandContract: any = null;\r\n\tprovider: any = null;\r\n\twallet: any = null;\r\n\tnumberList: any[] = [];\r\n\t\r\n\t@property(cc.Label)\r\n    label: cc.Label = null;\r\n\t\r\n\t@property(cc.Button)\r\n    accountButton: cc.Button = null;\r\n\t\r\n\t@property(cc.Button)\r\n    modeButton: cc.Button = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\t\r\n\t@property(cc.Prefab)\r\n    grassPrefab: cc.Prefab = null;\r\n\t\r\n\t@property(cc.Prefab)\r\n    chestPrefab: cc.Prefab = null;\r\n\t\r\n\t@property(cc.Prefab)\r\n    numberPrefab: cc.Prefab = null;\r\n\t\r\n\t@property(cc.JsonAsset)\r\n    rogueLandJson: cc.JsonAsset = null;\r\n\t\r\n\t// Player 节点，用于获取主角的位置\r\n\t@property(cc.Node)\r\n    player: cc.Node = null;\r\n\t\r\n\t// Camera 节点，用于获取摄像头的位置\r\n\t@property(cc.Node)\r\n    camera: cc.Node = null;\r\n\t\r\n\tspawnNewGrass (x, y, action) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newGrass = cc.instantiate(this.grassPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newGrass);\r\n        // 设置草地的位置\r\n        newGrass.setPosition(cc.v2(x,y));\r\n\t\t// 在草地脚本组件上保存 Camera 对象的引用\r\n        newGrass.getComponent('Grass').camera = this.camera;\r\n    },\r\n\t\r\n\tspawnNewChest (x, y) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newChest = cc.instantiate(this.chestPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newChest);\r\n\t\tnewChest.zIndex = 1;\r\n        // 设置宝箱的位置\r\n        newChest.setPosition(cc.v2(x,y));\r\n    },\r\n\t\r\n\tspawnNewNumber (x, y, action) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newNumber = cc.instantiate(this.numberPrefab)\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newNumber)\r\n\t\tnewNumber.zIndex = 1\r\n        // 设置数字的位置\r\n        newNumber.setPosition(cc.v2(x,y))\r\n\t\tlet color = new cc.Color(242,129,27)\r\n\t\tnewNumber.color = color\r\n\t\tnewNumber.getComponent(cc.Label).string = Number(this.t) + 1\r\n\t\t\r\n\t\tthis.numberList[this.t-this.currentSchedule] = {time: Number(this.t)+1, action: action, status: Status.Schedule, number: newNumber}\r\n    },\r\n\t\r\n\tsetLabel (t, x, y) {\r\n\t\tthis.text = `${this.mode}  T${t} (${x}, ${y})`\r\n\t\tthis.label.string = this.text;\r\n\t}\r\n\t\r\n\tasync commit () {\r\n        let action = this.numberList[this.toCommit-this.currentSchedule]\r\n\t\taction.status = Status.Committing\r\n\t\tconst rogueLandSigner = this.rogueLandContract.connect(this.wallet)\r\n\t\tawait rogueLandSigner.scheduleAction(this.id, action.action)\r\n\t\taction.status = Status.Committed\r\n\t\tthis.toCommit ++;\r\n\t\tcc.log('commit')\r\n    },\r\n\t\r\n\tasync loadPunk () {\r\n        let myPunk = JSON.parse(cc.sys.localStorage.getItem('myPunk'))\r\n\t\tif (myPunk) {\r\n\t\t  this.id = myPunk.id\r\n\t\t  let sprite = this.node.getChildByName('Player').getComponent(cc.Sprite)\r\n\t      cc.assetManager.loadRemote<cc.Texture2D>(myPunk.uri, { ext: '.png', cacheEnabled: true }, function (err, pic) {\r\n            if (err) {\r\n              cc.log('LoadNetImg load error,error:' + err)\r\n              return\r\n            }\r\n            sprite.spriteFrame = new cc.SpriteFrame(pic)\r\n          });\r\n\t\t}\r\n    },\r\n\t\r\n\tasync getStatus () {\r\n\t\tlet walletData = JSON.parse(cc.sys.localStorage.getItem('wallet'))\r\n\t\tconst walletPrivateKey = new ethers.Wallet(walletData.privateKey)\r\n\t\tthis.provider = new ethers.providers.JsonRpcProvider(\"https://data-seed-prebsc-1-s2.binance.org:8545/\")\r\n\t\tthis.wallet = walletPrivateKey.connect(this.provider)\r\n\t\tthis.rogueLandContract = new ethers.Contract(this.rogueLandAddress, this.rogueLandJson.json.abi, this.provider)\r\n\t\tlet balance = await this.wallet.getBalance();\r\n\t\tcc.log(balance/1e18)\r\n\t\tif (this.id > 0) {\r\n\t\t\tthis.goViewMode()\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst currentTime = await this.rogueLandContract.getCurrentTime()\r\n\t\t\tthis.t = currentTime\r\n\t\t    //this.setLabel(this.t, 0, 0)\r\n\t\t}\r\n    },\r\n\t\r\n\tloadAccount (e, msg) {\r\n\t\tcc.director.loadScene(\"user\");\r\n    },\r\n\t\r\n\tasync goViewMode() {\r\n\t\tconst statusInfo = await this.rogueLandContract.getCurrentStatus(this.id)\r\n\t\tthis.mode = \"view\"\r\n\t\tthis.t = statusInfo.t\r\n\t\tthis.player.x = statusInfo.x * 64\r\n\t\tthis.player.y = statusInfo.y * 64\r\n\t}\r\n\t\r\n\tasync goScheduleMode() {\r\n\t\tconst statusInfo = await this.rogueLandContract.getScheduleInfo(this.id)\r\n\t\tthis.mode = \"schedule\"\r\n\t\tthis.t = statusInfo.t\r\n\t\tthis.currentSchedule = statusInfo.t\r\n\t\tthis.toCommit = statusInfo.t\r\n\t\tthis.player.x = statusInfo.x * 64\r\n\t\tthis.player.y = statusInfo.y * 64\r\n\t}\r\n\t\r\n\tswitchMode (e, msg) {\r\n        if (this.mode == \"view\") {\r\n\t\t\tthis.goScheduleMode()\r\n\t\t}\r\n\t\telse if (this.mode == \"schedule\") {\r\n\t\t\tthis.goViewMode()\r\n\t\t}\r\n    },\r\n\t\r\n\t\r\n    update(dt) {\r\n\t\tif (Math.abs(this.player.x) < 9*64) {\r\n\t\t\tthis.camera.x = this.player.x\r\n\t\t}\r\n\t\tif (Math.abs(this.player.y) < 12*64) {\r\n\t\t\tthis.camera.y = this.player.y\r\n\t\t}\r\n\t\tthis.setLabel(this.t, this.player.x/64, this.player.y/64)\r\n\t}\r\n\t\r\n\tonKeyDown (event) {\r\n\t\t// set a flag when key pressed\r\n        \r\n\t\tswitch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n\t\t\tcase cc.macro.KEY.left:\r\n\t\t\t    if (this.mode == \"schedule\") {\r\n\t\t\t      this.spawnNewNumber(this.player.x, this.player.y, Action.GoLeft)\r\n\t\t\t      this.t ++;\r\n\t\t        }\r\n\t\t\t\tthis.player.getComponent('Player').moveLeft()\r\n                break;\r\n            case cc.macro.KEY.d:\r\n\t\t\tcase cc.macro.KEY.right:\r\n\t\t\t    if (this.mode == \"schedule\") {\r\n\t\t\t      this.spawnNewNumber(this.player.x, this.player.y, Action.GoRight)\r\n\t\t\t      this.t ++;\r\n\t\t        }\r\n                this.player.getComponent('Player').moveRight()\r\n                break;\r\n\t\t    case cc.macro.KEY.s:\r\n\t\t\tcase cc.macro.KEY.down:\r\n                if (this.mode == \"schedule\") {\r\n\t\t\t      this.spawnNewNumber(this.player.x, this.player.y, Action.GoDown)\r\n\t\t\t      this.t ++;\r\n\t\t        }\r\n\t\t\t\tthis.player.getComponent('Player').moveDown()\r\n                break;\r\n            case cc.macro.KEY.w:\r\n\t\t\tcase cc.macro.KEY.up:\r\n                if (this.mode == \"schedule\") {\r\n\t\t\t      this.spawnNewNumber(this.player.x, this.player.y, Action.GoUp)\r\n\t\t\t      this.t ++;\r\n\t\t        }\r\n\t\t\t\tthis.player.getComponent('Player').moveUp()\r\n                break;\r\n        }\r\n    },\r\n\t\r\n\tonLoad () {\r\n\t\tthis.label.node.zIndex = 1;\r\n\t\tthis.accountButton.node.zIndex = 1;\r\n\t\tthis.modeButton.node.zIndex = 1;\r\n\t\t// 生成草地\r\n        let windowSize=cc.view.getVisibleSize();\r\n        cc.log(\"width=\"+windowSize.width+\",height=\"+windowSize.height);\r\n\t\tfor (let i=-7; i<=7; i++) {\r\n\t\t\tfor (let j=-5; j<=5; j++) {\r\n\t\t\t\tthis.spawnNewGrass(i*64, j*64);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.spawnNewChest(64, 64)\r\n\t\t// 初始化键盘输入监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    },\r\n\r\n    start () {\r\n        // init logic\r\n        this.label.string = this.text\r\n\t\tthis.loadPunk()\r\n\t\tthis.getStatus()\r\n    }\r\n}\r\n"]}