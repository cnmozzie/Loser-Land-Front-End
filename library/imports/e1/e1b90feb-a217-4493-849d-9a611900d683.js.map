{"version":3,"sources":["assets\\Script\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport {ethers} from 'ethers/dist/ethers.umd.min.js';\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\r\n    @property(cc.Label)\r\n    label: cc.Label = null;\r\n\t\r\n\t@property(cc.Button)\r\n    button: cc.Button = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\t\r\n\t@property(cc.Prefab)\r\n    grassPrefab: cc.Prefab = null;\r\n\t\r\n\t@property(cc.Prefab)\r\n    chestPrefab: cc.Prefab = null;\r\n\t\r\n\t// Player 节点，用于获取主角的位置\r\n\t@property(cc.Node)\r\n    player: cc.Node = null;\r\n\t\r\n\t// Camera 节点，用于获取摄像头的位置\r\n\t@property(cc.Node)\r\n    camera: cc.Node = null;\r\n\t\r\n\tspawnNewGrass (x, y) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newGrass = cc.instantiate(this.grassPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newGrass);\r\n        // 设置草地的位置\r\n        newGrass.setPosition(cc.v2(x,y));\r\n\t\t// 在草地脚本组件上保存 Camera 对象的引用\r\n        newGrass.getComponent('Grass').camera = this.camera;\r\n    },\r\n\t\r\n\tspawnNewChest (x, y) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newChest = cc.instantiate(this.chestPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newChest);\r\n\t\tnewChest.zIndex = 1;\r\n        // 设置宝箱的位置\r\n        newChest.setPosition(cc.v2(x,y));\r\n    },\r\n\t\r\n\tloadPunk () {\r\n        let myPunk = JSON.parse(cc.sys.localStorage.getItem('myPunk'))\r\n\t\tif (myPunk) {\r\n\t\t  let sprite = this.node.getChildByName('Player').getComponent(cc.Sprite)\r\n\t      cc.assetManager.loadRemote<cc.Texture2D>(myPunk.uri, { ext: '.png', cacheEnabled: true }, function (err, pic) {\r\n            if (err) {\r\n              cc.log('LoadNetImg load error,error:' + err)\r\n              return\r\n            }\r\n            sprite.spriteFrame = new cc.SpriteFrame(pic)\r\n          });\r\n\t\t}\r\n    },\r\n\t\r\n\tasync gainScore () {\r\n\t\tconst provider = new ethers.providers.JsonRpcProvider(\"https://data-seed-prebsc-1-s2.binance.org:8545/\");\r\n\t\tthis.text = await provider.getBlockNumber()\r\n\t\tthis.label.string = this.text;\r\n        cc.log(this.text)\r\n    },\r\n\t\r\n\tonClick (e, msg) {\r\n        cc.log(msg);\r\n\t\tcc.director.loadScene(\"user\");\r\n    },\r\n\t\r\n\t\r\n    update(dt) {\r\n\t\tif (Math.abs(this.player.x) < 9*64) {\r\n\t\t\tthis.camera.x = this.player.x\r\n\t\t}\r\n\t\tif (Math.abs(this.player.y) < 12*64) {\r\n\t\t\tthis.camera.y = this.player.y\r\n\t\t}\r\n\t}\r\n\t\r\n\tonLoad () {\r\n        this.label.node.zIndex = 1;\r\n\t\tthis.button.node.zIndex = 1;\r\n\t\t// 生成草地\r\n        let windowSize=cc.view.getVisibleSize();\r\n        cc.log(\"width=\"+windowSize.width+\",height=\"+windowSize.height);\r\n\t\tfor (let i=-7; i<=7; i++) {\r\n\t\t\tfor (let j=-5; j<=5; j++) {\r\n\t\t\t\tthis.spawnNewGrass(i*64, j*64);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.spawnNewChest(64, 64)\r\n    },\r\n\r\n    start () {\r\n        // init logic\r\n        this.label.string = this.text\r\n\t\tthis.loadPunk()\r\n\t\tthis.gainScore()\r\n    }\r\n}\r\n"]}